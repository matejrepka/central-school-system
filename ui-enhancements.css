/* UI enhancements: use site CSS variables so styles adapt to dark-mode */
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; color: var(--text-color); }
.subject-row, .subject { border:1px solid var(--border); padding:12px; border-radius:6px; margin-bottom:10px; background: var(--card-bg); box-shadow: 0 2px 6px var(--card-shadow); color: var(--text-color); }
.subject-row.mandatory { background: color-mix(in srgb, var(--card-bg) 92%, var(--accent) 8%); border-color: var(--border); }
.subject-row .title { display:flex; align-items:center; gap:8px; font-size:1.05rem; }
.subject-row .title .code { color: var(--muted-2); font-size:0.9rem; margin-left:6px }
.subject-row .links, .subject-row .time { margin-top:8px }
.subject-row .links em, .subject-row .time em { font-style:normal; color: var(--text-color); font-weight:600; margin-right:6px }
.links-list .link-item { margin:6px 0 }
.no-links, .no-schedule { color: var(--muted) }
table { border-collapse:collapse; width:100%; }
td { padding:4px 8px; border-bottom:1px solid rgba(0,0,0,0.04) }
.type-cell { text-transform:capitalize; font-weight:600 }

/* Form and editors */
.task-form input, .task-form select, .task-form button { font-size:1rem }
.control { padding:10px 12px; border:1px solid #ddd; border-radius:6px; box-sizing:border-box; background:#fff; font-size:0.98rem }
.control:focus { outline:2px solid rgba(42,93,159,0.18); border-color:#2a5d9f }

/* Ensure selects and dropdowns follow dark-mode theme */
.control[type="time"], .control[type="date"], .control[type="url"], .control[type="text"], .control, select, textarea {
  background: var(--input-bg);
  color: var(--text-color);
  border: 1px solid var(--border);
}

/* Style native select and options; note some browsers limit option styling but most will apply basic colors */
select {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background: var(--input-bg);
  color: var(--text-color);
  padding-right: 30px; /* room for arrow */
}
select:focus { outline: 3px solid color-mix(in srgb, var(--accent) 14%, transparent); border-color: var(--accent); }
select option { background: var(--card-bg); color: var(--text-color); }

/* simple custom arrow for selects (non-invasive) */
select { background-image: linear-gradient(45deg, transparent 50%, var(--muted-2) 50%), linear-gradient(135deg, var(--muted-2) 50%, transparent 50%); background-position: calc(100% - 18px) calc(1em + 2px), calc(100% - 13px) calc(1em + 2px); background-size: 6px 6px, 6px 6px; background-repeat: no-repeat; }

/* Force text color in some WebKit browsers for inputs/selects */
.control, select, textarea { -webkit-text-fill-color: var(--text-color); }

/* Windows/Edge/IE expand arrow appearance tweak */
select::-ms-expand { filter: invert(1); }

/* Dark-mode explicit rules for dropdown options (some browsers ignore option styles, but try to help) */
body.dark-mode select, body.dark-mode .control { background: var(--input-bg); color: var(--text-color); }
body.dark-mode select option { background: var(--card-bg); color: var(--text-color); }

/* Mode toggle should also follow variables */
#modeToggle { background: var(--card-bg); color: var(--text-color); border:1px solid var(--border); box-shadow: 0 2px 6px var(--card-shadow); }
#modeToggle:hover { filter: brightness(1.04); }

/* textarea and placeholder color */
textarea { background: var(--input-bg); color: var(--text-color); border: 1px solid var(--border); }
::placeholder { color: var(--muted); }
.controls { display:flex; flex-direction:column; gap:8px; align-items:stretch }
.controls .control { width:100% }
.controls--links .btn--small { align-self:flex-start }
.controls--schedule .btn--small { align-self:flex-start }

/* New form rows layout */
.form-rows { display:flex; flex-direction:column; gap:12px }
.form-row { display:flex; gap:12px; align-items:center }
.form-row--split label { flex:1; display:flex; flex-direction:column }
.form-row--inline { align-items:flex-start }
.inline-controls { display:flex; gap:8px; align-items:center; flex-wrap:wrap }
.inline-controls .control { min-width:120px }
.form-row--actions { justify-content:flex-end }

@media (max-width:700px) {
  .form-row { flex-direction:column; align-items:stretch }
  .inline-controls { flex-direction:column; align-items:stretch }
  .inline-controls .control { width:100% }
}
.task-form .row label { width:100%; display:block }
.task-form #linksEditor, .task-form #scheduleEditor { background: var(--card-bg); border: 1px solid var(--border); border-radius:6px; padding:10px }
.task-form #linksList > div, .task-form #scheduleList > div { display:flex; align-items:center; gap:8px; justify-content:space-between }

.controls .control, .task-form #linksList > div, .task-form #scheduleList > div { padding:8px 6px }
.controls { padding:6px }
.links-list { margin-top:8px }
.link-item a { color: var(--link-color); }
.link-item a:hover { color: var(--accent); text-decoration: underline }
.subject { margin-bottom:12px }

/* Inline chips for links and schedule under the title */
.links-inline, .sched-inline { display:flex; gap:8px; flex-wrap:wrap; margin-top:6px }
.links-inline .link-item, .sched-inline .sched-item { background:transparent; border:none; padding:0; border-radius:0; font-size:0.95rem; color: var(--text-color) }
.links-inline .link-item a { color: var(--link-color); text-decoration:underline }
.sched-inline .sched-item .sched-type { margin-left:6px; color:inherit; font-weight:normal }
/* Schedule type colors - use theme variables where possible */
.sched-item.lecture { color: var(--accent) }
.sched-item.exercise { color: var(--time-color) }
.sched-item.course { color: color-mix(in srgb, var(--accent) 40%, var(--time-color) 60%) }
.no-links, .no-schedule { color: var(--muted) }

/* Subject card delete button (small x at top-right) */
.subject { position:relative }
.subject .subject-actions { position:absolute; top:8px; right:8px }
.delete-x { background:transparent; border:none; color: var(--muted-2); font-size:18px; line-height:1; padding:4px; border-radius:4px; cursor:pointer }
.delete-x:hover { color: var(--accent) }

/* Ensure subject headings and content inherit correct text color */
.subject h3, .subject .content, .subject .links, .subject .time { color: var(--text-color) }

/* Buttons */
.btn { cursor:pointer; background: var(--accent); color: #fff; border:none; padding:10px 14px; border-radius:6px; font-weight:600 }
.btn--small { padding:8px 10px; font-size:0.95rem }
.btn[disabled] { opacity:0.6; cursor:not-allowed }
.btn:hover { filter: brightness(1.03); }

/* form actions */
.form-actions { display:flex; justify-content:flex-end; margin-top:10px }

/* Responsive small screens */
@media (max-width:700px) {
  .subject-row .title { flex-direction:column; align-items:flex-start }
  .task-form #scheduleEditor div[style] { display:block }
}
